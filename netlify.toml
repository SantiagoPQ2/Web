#############################################
# üèóÔ∏è CONFIGURACI√ìN DE BUILD Y FUNCIONES
#############################################

[build]
  command = "npm run build"
  functions = "netlify/functions"
  publish = "dist"

#############################################
# ‚öôÔ∏è CONFIGURACI√ìN DE FUNCIONES SERVERLESS
#############################################

[functions]
  included_files = [
    "netlify/functions/*.py",
    "netlify/functions/requirements.txt"
  ]

# Forzamos a usar runtime de Python 3.11 en la funci√≥n principal
[functions."procesar_planilla"]
  runtime = "python3.11"
  included_files = ["netlify/functions/requirements.txt"]

#############################################
# üß† CONFIGURACI√ìN OPCIONAL (LOGS Y TIMEOUTS)
#############################################

# Permite funciones m√°s largas (PDFs grandes)
[functions.settings]
  timeout = 50
  memory = 1024

#############################################
# üö´ CONTROL DE CACHE (tus headers originales)
#############################################

[[headers]]
  for = "/*"
  [headers.values]
  Cache-Control = "no-cache, no-store, must-revalidate"

[[headers]]
  for = "/sw.js"
  [headers.values]
  Cache-Control = "no-store, no-cache, must-revalidate, max-age=0"

[[headers]]
  for = "/assets/*"
  [headers.values]
  Cache-Control = "public, max-age=31536000, immutable"

#############################################
# ‚úÖ DEBUG OPCIONAL PARA VERIFICAR DETECCI√ìN
#############################################

# Esto genera logs detallados de funciones en el build (muy √∫til la primera vez)
[build.environment]
  NETLIFY_USE_PYTHON_VERSION = "3.11"
  PYTHONPATH = "netlify/functions"
  LOG_LEVEL = "debug"
